[검수]

* 주의할 점
	- 컬럼을 임의로 수정하거나 위치를 옮기면 안됨
	- 4단계 프로그램을 돌릴때는 반드시 돌리기 전과 돌린 후 파일을 백업해 보관
	- 3단계 작업량 집계에 영향을 미칠 수 있는 항목에서(업체, 매장, 제품, UPC) 오류가 발생해 검출될 경우 반드시 (작업자 명, PK, 오류, 수정한 내용) 기록
	- 가격과 수량에서 실수가 아닌 방법을 몰라서 발생한 오류인 경우 작업자에게 알려줘야 하므로 기록

-> 작업자별 3단계 작업 완료 파일을 4단계 프로그램에서 돌린다.(1)
	4단계 프로그램 오류는 F19가 입력되지 않은 경우가 대다수이므로 오류가 나면 F19에 공백이 없는지 확인

-> ((1)의 결과 파일내 파일명 컬럼의 Unique 파일명 개수)+(제외 파일 수)가 (금일 전체 인보이스 수)와 같은지 확인
	=> 다를 경우 처리 안된 파일을 찾아내 따로 작업하고 최종에 합침
	* 이전 인보이스 중에서 넘어온거나 검수과정에서 제외한 인보이스 등을 잘 파악하여 진행
	* BAKHTAR BAKERY 인보이스 파일과 PACIFIC BLUE CORPORATION(PBC)의 엑셀 파일은 따로 작업하여 4단계까지 따로 작업한 후 합침

-> 각 인보이스 별 분류 내용이 공백이 아닌 경우가 너무 많은 경우 전수 검사
	=> 업체 코드가 잘못입력되면 전체 항목이 Lookup이 안되며, 제품코드나 UPC는 잘못된 규칙을 입력하거나 다른 컬럼의 값을 입력하면 또 많이 Lookup 실패

-> 컬럼별 검수
	처리 내용에 항목을 제거하거나 삭제해야한다는 항목이 있는지 확인
		만약 파일 전체가 삭제 대상이라면 삭제 후 제외 파일에 추가
	F1000의 점포 코드를 하나씩 선택해 파일명과 대조하여 점포 코드 잘못 입력한 케이스는 없는지 확인
	Description 공백이 있는지 확인
	F39 날짜 포맷이 M/D/YYYY 형식인지, 연도가 이상한 점은 없는지 확인
		엑셀 자동 채우기 기능을 써서 연도가 1씩 증가하면서 입력하는 경우나 날짜가 너무 먼 미래인 경우(1월 작업에 11월 날짜) 인보이스 확인하여 정확히 입력
	DupFlag가 1인 항목이 실제 중복되어 합쳐진 것인지 확인
		실제 중복이 아닌데 DupFlag가 1이상인 경우 해당 항목이 포함된 인보이스를 전수 검수하여 잘못 합쳐진 항목 찾아내고 없어진 항목 신상품 새로 추가하고 DupFlag는 0으로 수정(DupFlag는 0이면 단일, 1이상인 경우는 각각 숫자+1개가 중복된 경우 -> 갯수만큼 다 찾아봐야함)
		JFC와 WISMETTAC(NISHIMOTO)는 CASE와 EACH인 항목들이 중복처리된 경우 원본을 참조하여 CASE를 EACH로 변환해서(QTY에 F19를 곱함) 갯수와 총금액 다 합치고 단가 계산해서 금액 입력하고 C or E를 E로, flagProcessed를 1로 수정
	Amount 우측에 컬럼을 하나 추가해 Amount/(F38*QTY)을 계산하여 1에서 0.0001이상 차이가 나는 모든 항목 가격, 수량, 총금액 체크
		값이 틀린 경우 인보이스 확인하여 가격, 수량, 총금액 제대로 다시 입력
			Each인 경우에는 단가와 총금액은 F19가 곱해져있는 값이 올바른 것
	NEW CASE COST가 공백이 아닌 항목을 필터로 걸고 NEW CASE COST 우측에 컬럼을 추가해 F38/(OLD CASE COST)를 계산하여 0.5 이하, 2 이상인 항목의 가격, 수량, 총금액 체크
		차이가 나는 경우 제품코드/UPC가 잘못되었거나 가격 및 수량이 잘못 입력, Case/Each 구분 오류 등이 있을 수 있음
			만약 Case/Each 구분이 틀려서 발생한 경우 C인데 E로 잘못 입력된 경우이면 단가 및 총금액에서 F19를 나눈 값을 입력
				반대의 경우는 F19를 곱해줌
	업체 B.K.Miller(1201) 검색하여 추가 작업
		Fuel Surcharge를 PEDP5050406(없으면 상단 첫번째 제품)의 총금액에 더하고 Unit cost도 거기에 맞게 조정

-> 4단계 프로그램 다시 돌리기(2)

-> NEW MARGIN이 음수가 되거나 1.5 이상으로 큰 경우 NEW CASE COST와 동일한 오류 유형 체크
	수정 사항이 생기면 4단계 프로그램 다시 돌리기(3)

-> flagProcessedCE가 1인 항목을 필터링하여 F38과 Amount에 F19를 곱한 값을 수기로 입력

-> 검수가 끝난 완성 파일들은 최종에 4단계에 함께 돌려 최종통합본을 생성
	* 이 최종 과정에서 생성된 SRP RESULT 파일들을 압축


[결과 파일 생성]

1. 통합작업본
검수를 마친 파일을 두 개 복사하여 하나는 PK, 작업 내용, 처리 내용, DupFlag, C or E, flagProcessedCE 컬럼을 모두 제거한 뒤에 "통합작업본_mmddyyyy_작업완료원본"라고 이름 변경
나머지 하나는 PK, 작업 내용, 처리 내용, UPC check ~ 후보 UPC, Lookup F26, 원본 F26, Lookup F26 동일 체크, Description Lookup 기준, DupFlag, C or E, flagProcessedCE 컬럼을 모두 제거하고 "통합작업본_mmddyyyy"로 이름 변경
각각 컬럼수가 33개, 24개이므로 작업 후 컬럼 수 확인

2. 제외인보이스
제외 파일을 "제품코드, UPC 부재 & 한글 Description & 수기", "입력 대상 제품 없음", "업체코드 검색 불가", "파본", "가격 수량 정보 없음"로 구분해 각 폴더로 이동시키고 전체를 압축하여 "제외인보이스_mmddyyyy"로 이름 변경

3. PB 배치 파일
루트 폴더(C:\Users\user\PycharmProjects\lotteplaza\)의 srp_result라는 폴더로 들어가 마지막 4단계 작업 시 입력한 구분명 폴더 내 모든 파일을 압축하여 "PB batch files_mmddyyyy"로 이름 변경

4. 작업량 기록
지난 결과 파일에서 "Data_Entry_작업량_기록_mmddyyyy" 파일을 그대로 복사해 1단계(작업자가 작업한 1단계 수 총합), 3단계(최종 검수 완료 파일의 분류가 공백이 아닌 항목 수) 작업량을 기입하고 날짜를 오늘 날짜로 변경
=> 총 5개 파일을 메일로 보내고 전무님께는 4의 금일 작업량과 각 작업자별 1단계, 3단계(실제 작업한 양) 작업량, 수~금인 경우 내근알바 출퇴근 시각을 보고